<Window x:Class="BusOrderSystem.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:BusOrderSystem"
        mc:Ignorable="d"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
xmlns:col="clr-namespace:System.Collections;assembly=mscorlib" 
        Style="{StaticResource CustomWindowStyle}"
        Title="Система заказа автобусов" Height="700" Width="1000"
        FontFamily="Segoe UI" Closing="Window_Closing">
    <Window.Resources>
        <local:BusIdToNameConverter x:Key="BusIdToNameConverter"/>
        <local:DriverIdToNameConverter x:Key="DriverIdToNameConverter"/>
        <local:ModelIdToNameConverter x:Key="ModelIdToNameConverter"/>
        <local:CustomerIdToNameConverter x:Key="CustomerIdToNameConverter"/>
        <local:FleetIdToNameConverter x:Key="FleetIdToNameConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="6*" MaxHeight="60"/>
            <RowDefinition Height="3*" MaxHeight="30"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="4*" MaxHeight="40"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" >
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                <TextBlock Text="🚌" FontSize="30" Margin="0,0,10,0"/>
                <TextBlock Text="Система заказа автобусов" FontSize="20" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <StatusBar Grid.Row="1">
            <Menu VerticalAlignment="Center">
                <MenuItem x:Name="FileMenuItem" Header="Файл" >
                    <MenuItem x:Name="AddMenuItem" Header="Добавить" Click="AddClick" VerticalContentAlignment="Center"/>
                    <MenuItem x:Name="ExitMenuItem" Header="Выход" InputGestureText="Alt + F4" Click="ExitClick" VerticalContentAlignment="Center"/>
                </MenuItem>
                <MenuItem x:Name="ToolsMenuItem" Header="Средства">
                    <MenuItem x:Name="ProviderMenuItem" Header="Провайдеры" VerticalContentAlignment="Center">
                        <MenuItem Name="SQLiteMenuItem" Header="SQLite" Click="SQLiteClick"/>
                        <MenuItem Name="SQLServerMenuItem" Header="SQL Server" Click="SQLServerClick"/>
                    </MenuItem>
                    <MenuItem x:Name="ThemesMenuItem" Header="Темы" VerticalContentAlignment="Center">
                        <MenuItem Header="Deep Dark" Click="ChangeTheme" Uid="0">
                            <MenuItem.Icon>
                                <Rectangle Stroke="#FF232323" Fill="#FF1B1B1B" StrokeThickness="2" StrokeLineJoin="Round" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Soft Dark (default)" Click="ChangeTheme" Uid="1">
                            <MenuItem.Icon>
                                <Rectangle Stroke="#FF404040" Fill="#FF2A2A2A" StrokeThickness="2" StrokeLineJoin="Round" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Dark Grey" Click="ChangeTheme" Uid="2">
                            <MenuItem.Icon>
                                <Rectangle Stroke="#FF737373" Fill="#FF4E4E4E" StrokeThickness="2" StrokeLineJoin="Round" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Grey" Click="ChangeTheme" Uid="3">
                            <MenuItem.Icon>
                                <Rectangle Stroke="#FFB3B3B3" Fill="#FF797979" StrokeThickness="2" StrokeLineJoin="Round" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Light" Click="ChangeTheme" Uid="4">
                            <MenuItem.Icon>
                                <Rectangle Stroke="#FF848484" Fill="#FFE8E8E8" StrokeThickness="2" StrokeLineJoin="Round" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Red" Click="ChangeTheme" Uid="5">
                            <MenuItem.Icon>
                                <Rectangle Stroke="#FFFF1A1A" Fill="#FFED1C1C" StrokeThickness="2" StrokeLineJoin="Round" />
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                </MenuItem>
                <MenuItem x:Name="AboutMenuItem" Header="О программе" Click="AboutClick"/>
            </Menu>
        </StatusBar>
        


        <TabControl x:Name="TCBusOrderSystem" Grid.Row="2" Margin="10" BorderThickness="1">

            <TabItem Header="Модели">
                <DataGrid x:Name="ModelsDataGrid"
                    AutoGenerateColumns="False"
                    IsReadOnly="True"
                    ItemsSource="{Binding BusModels}"
                    SelectionUnit="FullRow" HeadersVisibility="Column" 
                    HorizontalAlignment="Left" 
                    VerticalAlignment="Top">


                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding ModelId}" Width="50"/>
                        <DataGridTextColumn Header="Название" Binding="{Binding ModelName}" Width="120"/>
                        <DataGridTextColumn Header="Производитель" Binding="{Binding ManufacturerCompany}" Width="100"/>
                        <DataGridTextColumn Header="Страна" Binding="{Binding ManufacturerCountry}" Width="80"/>
                        <DataGridTextColumn Header="Вместимость" Binding="{Binding Capacity}" Width="80"/>
                        <DataGridTextColumn Header="Цена" Binding="{Binding Price, StringFormat='{}{0:N2} ₽'}" Width="100"/>
                    </DataGrid.Columns>
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Добавить" Click="AddClick"/>
                            <MenuItem Header="Редактировать" Click="EditClick"/>
                            <MenuItem Header="Удалить" Click="DeleteClick"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                </DataGrid>
            </TabItem>

            <TabItem Header="Автопарки">
                <DataGrid x:Name="FleetsDataGrid" AutoGenerateColumns="False" IsReadOnly="True" SelectionUnit="FullRow" ItemsSource="{Binding BusFleets}"
                HorizontalAlignment="Left" 
                VerticalAlignment="Top">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding FleetId}" Width="50"/>
                        <DataGridTextColumn Header="Название" Binding="{Binding FleetName}" Width="120"/>
                        <DataGridTextColumn Header="Адрес" Binding="{Binding Address}" Width="150"/>
                        <DataGridTextColumn Header="Телефон" Binding="{Binding ContactPhone}" Width="100"/>
                        <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="120"/>
                        <DataGridTextColumn Header="Регион" Binding="{Binding Region}" Width="100"/>
                        <DataGridTextColumn Header="Ставка %/ч" Binding="{Binding HourlyRate, StringFormat=F6}" Width="100"/>
                        <DataGridTextColumn Header="Ставка ₽/км" Binding="{Binding KilometerRate, StringFormat=F3}" Width="100"/>
                    </DataGrid.Columns>
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Добавить" Click="AddClick"/>
                            <MenuItem Header="Редактировать" Click="EditClick"/>
                            <MenuItem Header="Удалить" Click="DeleteClick"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                </DataGrid>
            </TabItem>

            <TabItem Header="Смены">
                <DataGrid x:Name="ShiftsDataGrid" AutoGenerateColumns="False" IsReadOnly="True" SelectionUnit="FullRow" ItemsSource="{Binding Shifts}"
                HorizontalAlignment="Left" 
                VerticalAlignment="Top">

                    
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding ShiftId}" Width="50"/>
                        <DataGridTemplateColumn Header="Автопарк" Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding FleetId}"
                                    ToolTip="{Binding FleetId, Converter={StaticResource FleetIdToNameConverter}}"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center" MinWidth="40" Margin="2,0,0,0"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTextColumn Header="Название" Binding="{Binding ShiftName}" Width="100"/>
                        <DataGridTextColumn Header="Начало" Binding="{Binding StartTime, StringFormat=HH:mm}" Width="80"/>
                        <DataGridTextColumn Header="Конец" Binding="{Binding EndTime, StringFormat=HH:mm}" Width="80"/>
                    </DataGrid.Columns>
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Добавить" Click="AddClick"/>
                            <MenuItem Header="Редактировать" Click="EditClick"/>
                            <MenuItem Header="Удалить" Click="DeleteClick"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                </DataGrid>
            </TabItem>

            <TabItem Header="Автобусы">
                <DataGrid x:Name="BusesDataGrid" AutoGenerateColumns="False" IsReadOnly="True" SelectionUnit="FullRow" ItemsSource="{Binding Buses}"
                HorizontalAlignment="Left" 
                VerticalAlignment="Top">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding BusId}" Width="50"/>
                        <DataGridTextColumn Header="Номер" Binding="{Binding BusNumber}" Width="100"/>
                        <DataGridTemplateColumn Header="Модель" Width="60">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding ModelId}"
                                    ToolTip="{Binding ModelId, Converter={StaticResource ModelIdToNameConverter}}"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center" MinWidth="40" Margin="2,0,0,0"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="Автопарк" Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding FleetId}"
                                    ToolTip="{Binding FleetId, Converter={StaticResource FleetIdToNameConverter}}"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center" MinWidth="40" Margin="2,0,0,0"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Пробег, км" Binding="{Binding Mileage}" Width="100"/>
                    </DataGrid.Columns>
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Добавить" Click="AddClick"/>
                            <MenuItem Header="Редактировать" Click="EditClick"/>
                            <MenuItem Header="Удалить" Click="DeleteClick"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                </DataGrid>
            </TabItem>

            <TabItem Header="Водители">
                <DataGrid x:Name="DriversDataGrid" AutoGenerateColumns="False" IsReadOnly="True" SelectionUnit="FullRow" ItemsSource="{Binding Drivers}"
                HorizontalAlignment="Left" 
                VerticalAlignment="Top">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding DriverId}" Width="50"/>
                        <DataGridTextColumn Header="Имя" Binding="{Binding FirstName}" Width="100"/>
                        <DataGridTextColumn Header="Фамилия" Binding="{Binding LastName}" Width="100"/>
                        <DataGridTemplateColumn Header="Автопарк" Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding FleetId}"
                                    ToolTip="{Binding FleetId, Converter={StaticResource FleetIdToNameConverter}}"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center" MinWidth="40" Margin="2,0,0,0"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Стаж, лет" Binding="{Binding ExperienceYears}" Width="80"/>
                        <DataGridTextColumn Header="Дата приёма" Binding="{Binding EmploymentDate, StringFormat=d}" Width="100"/>
                    </DataGrid.Columns>
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Добавить" Click="AddClick"/>
                            <MenuItem Header="Редактировать" Click="EditClick"/>
                            <MenuItem Header="Удалить" Click="DeleteClick"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                </DataGrid>
            </TabItem>

            <TabItem Header="Клиенты">
                <DataGrid x:Name="CustomersDataGrid" AutoGenerateColumns="False" IsReadOnly="True" SelectionUnit="FullRow" ItemsSource="{Binding Customers}"
                HorizontalAlignment="Left" 
                VerticalAlignment="Top">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding CustomerId}" Width="50"/>
                        <DataGridTextColumn Header="Имя" Binding="{Binding Name}" Width="150"/>
                        <DataGridTextColumn Header="Телефон" Binding="{Binding Phone}" Width="120"/>
                        <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="150"/>
                    </DataGrid.Columns>
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Добавить" Click="AddClick"/>
                            <MenuItem Header="Редактировать" Click="EditClick"/>
                            <MenuItem Header="Удалить" Click="DeleteClick"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                </DataGrid>
            </TabItem>

            <TabItem Header="Заказы">
                <DataGrid x:Name="OrdersDataGrid" AutoGenerateColumns="False" IsReadOnly="True" SelectionUnit="FullRow" ItemsSource="{Binding Orders}"
                HorizontalAlignment="Left" 
                VerticalAlignment="Top">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding OrderId}" Width="50"/>
                        <DataGridTemplateColumn Header="Клиент" Width="60">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding CustomerId}"
                                    ToolTip="{Binding CustomerId, Converter={StaticResource CustomerIdToNameConverter}}"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center" MinWidth="40" Margin="2,0,0,0"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="Автобус" Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding BusId}"
                                    ToolTip="{Binding BusId, Converter={StaticResource BusIdToNameConverter}}"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center" MinWidth="40" Margin="2,0,0,0"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="Водитель" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding DriverId}"
                                    ToolTip="{Binding DriverId, Converter={StaticResource DriverIdToNameConverter}}"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center" MinWidth="40" Margin="2,0,0,0"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Начало" Binding="{Binding StartTime, StringFormat=dd.MM HH:mm}" Width="100"/>
                        <DataGridTextColumn Header="Конец" Binding="{Binding EndTime, StringFormat=dd.MM HH:mm}" Width="100"/>
                        <DataGridTextColumn Header="Расстояние, км" Binding="{Binding DistanceKm}" Width="100"/>
                    </DataGrid.Columns>
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Добавить" Click="AddClick"/>
                            <MenuItem Header="Редактировать" Click="EditClick"/>
                            <MenuItem Header="Удалить" Click="DeleteClick"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                </DataGrid>
            </TabItem>
        </TabControl>

        <StatusBar Grid.Row="3">
            <StatusBarItem>
                <TextBlock x:Name="Status" Text="Готово" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>